{
	"app-id": "org.octave.Octave",
	"runtime": "org.kde.Sdk",
	"runtime-version": "5.9",
	"sdk": "org.kde.Sdk",
	"command": "octave",
	"rename-icon": "octave",
	"rename-desktop-file": "www.octave.org-octave.desktop",
	"rename-appdata-file": "www.octave.org-octave.appdata.xml",
	"finish-args":
	[
		"--socket=wayland",
		"--socket=x11",
		"--socket=pulseaudio",
		"--share=network",
		"--device=dri",
		"--filesystem=home"
	],
	"build-options":
	{
		"cflags": "-O2",
		"cxxflags": "-O2"
	},
	"modules":
	[
		{
			"name": "gcc-fortran",
			"build-options":
			{
				"ldflags": "-static-libgcc"
			},
			"config-opts":
			[
				"--enable-languages=c,c++,fortran",
				"--disable-multilib",
				"--disable-bootstrap",
				"--with-system-zlib",
				"--enable-checking=release",
				"--disable-stage1-checking",
				"--disable-libsanitizer",
				"--disable-libssp"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "http://mirrors.kernel.org/gnu/gcc/gcc-7.1.0/gcc-7.1.0.tar.gz",
					"sha256": "3c187ef42e4cf657eec0ed641aac7f7e46261bcb1cea31b72dcf2dedddbbdea5"
				},
				{
					"type": "shell",
					"commands":
					[
						"sed -e '/m64=/s/lib64/lib/' -i.orig gcc/config/i386/t-linux64"
					]
				}
			]
		},
		{
			"name": "openblas",
			"no-autogen": true,
			"build-options":
			{
				"ldflags": "-L/app/lib64"
			},
			"make-args":
			[
				"FC=gfortran",
				"DYNAMIC_ARCH=1"
			],
			"make-install-args":
			[
				"PREFIX=/app"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "https://github.com/xianyi/OpenBLAS/archive/v0.2.20.tar.gz",
					"sha256": "5ef38b15d9c652985774869efd548b8e3e972e1e99475c673b25537ed7bcf394"
				}
			]
		},
		{
			"name": "glu",
			"sources": [
			{
				"type": "archive",
				"url": "https://mesa.freedesktop.org/archive/glu/glu-9.0.0.tar.bz2",
				"sha256": "1f7ad0d379a722fcbd303aa5650c6d7d5544fde83196b42a73d1193568a4df12"
			}
			],
			"cleanup": [ "/include", "/lib/*.a", "/lib/*.la", "/lib/pkgconfig" ]
		},
		{
			"name": "gnuplot",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://sourceforge.net/projects/gnuplot/files/gnuplot/5.0.6/gnuplot-5.0.6.tar.gz",
					"sha256": "5bbe4713e555c2e103b7d4ffd45fca69551fff09cf5c3f9cb17428aaacc9b460"
				}
			]
		},
		{
			"name": "fontconfig",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://www.freedesktop.org/software/fontconfig/release/fontconfig-2.12.1.tar.gz",
					"sha256": "a9f42d03949f948a3a4f762287dbc16e53a927c91a07ee64207ebd90a9e5e292"
				}
			]
		},
		{
			"name": "freetype",
			"sources":
			[
				{
					"type": "archive",
					"url": "http://download.savannah.gnu.org/releases/freetype/freetype-2.8.tar.gz",
					"sha256": "33a28fabac471891d0523033e99c0005b95e5618dc8ffa7fa47f9dadcacb1c9b"
				}
			]
		},
		{
			"name": "fltk",
			"config-opts":
			[
				"--enable-shared"
			],
			"build-options":
			{
				"cflags": "-fPIC",
				"cxxflags": "-fPIC"
			},
			"sources":
			[
				{
					"type": "archive",
					"url": "http://fltk.org/pub/fltk/1.3.4/fltk-1.3.4-1-source.tar.gz",
					"sha256": "7fb2c8882433ce694e6900c94fda505e8f4ed3fa9c7e597007098a33b85c53f4"
				}
			]
		},
		{
			"name": "cups",
			"config-opts":
			[
				"--disable-static",
				"--disable-dbus",
				"--without-php",
				"--disable-gssapi",
				"--disable-ssl",
				"--disable-cdsassl",
				"--disable-gnutls",
				"--disable-pam",
				"--disable-dnssd",
				"--disable-launchd",
				"--libdir=/app/lib"
			],
			"make-args":
			[
				"libs"
			],
			"no-make-install": true,
			"sources":
			[
				{
					"type": "archive",
					"url": "https://github.com/apple/cups/archive/v2.2.3.tar.gz",
					"sha256": "7aa7e8d581f0eb204f75203082403bfa931f8c058bffae71b210800102e5feb5"
				}
			],
			"post-install":
			[
				"make install-libs", "chmod +w /app/lib/libcups*"
			]
		},
		{
			"name": "ghostscript",
			"build-options":
			{
				"ldflags": "-L/app/lib"
			},
			"sources":
			[
				{
					"type": "archive",
					"url": "https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs921/ghostscript-9.21.tar.gz",
					"sha256": "02bceadbc4dddeb6f2eec9c8b1623d945d355ca11b8b4df035332b217d58ce85"
				}
			]
		},
		{
			"name": "gl2ps",
			"buildsystem": "cmake",
			"sources":
			[
				{
					"type": "archive",
					"url": "http://geuz.org/gl2ps/src/gl2ps-1.4.0.tgz",
					"sha256": "03cb5e6dfcd87183f3b9ba3b22f04cd155096af81e52988cc37d8d8efe6cf1e2"
				}
			]
		},
		{
			"name": "qhull",
			"buildsystem": "cmake",
			"sources":
			[
				{
					"type": "archive",
					"url": "http://www.qhull.org/download/qhull-2015-src-7.2.0.tgz",
					"sha256": "78b010925c3b577adc3d58278787d7df08f7c8fb02c3490e375eab91bb58a436"
				}
			]
		},
		{
			"name": "epstool",
			"no-autogen": true,
			"make-install-args": ["EPSTOOL_BASE=/app"],
			"sources":
			[
				{
					"type": "archive",
					"url": "http://pkgs.fedoraproject.org/repo/pkgs/epstool/epstool-3.08.tar.gz/465a57a598dbef411f4ecbfbd7d4c8d7/epstool-3.08.tar.gz",
					"sha256": "f3f14b95146868ff3f93c8720d5539deef3b6531630a552165664c7ee3c2cfdd"
				}
			]
		},
		{
			"name": "hdf5",
			"no-autogen": true,
			"sources":
			[
				{
					"type": "archive",
					"path": "hdf5 1.1.tar.bz2",
					"sha256": "9c5ce1e33d2463fb1a42dd04daacbc22104e57676e2204e3d66b1ef54b88ebf2"
				}
			]
		},
		{
			"name": "qrupdate",
			"make-install-args": ["PREFIX=/app", "BLAS=-lopenblas", "LAPACK="],
			"no-autogen": true,
			"sources":
			[
				{
					"type": "archive",
					"url": "https://sourceforge.net/projects/qrupdate/files/qrupdate/1.2/qrupdate-1.1.2.tar.gz",
					"sha256": "e2a1c711dc8ebc418e21195833814cb2f84b878b90a2774365f0166402308e08"
				}
			]
		},
		{
			"name": "suitesparse",
			"build-options":
			{
				"cflags": "-L/app/lib"
			},
			"make-args": ["LAPACK=", "library"],
			"make-install-args": ["LAPACK=", "INSTALL_LIB=/app/lib", "INSTALL_INCLUDE=/app/include", "library"],
			"no-autogen": true,
			"sources":
			[
				{
					"type": "archive",
					"url": "http://faculty.cse.tamu.edu/davis/SuiteSparse/SuiteSparse-4.5.5.tar.gz",
					"sha256": "b9a98de0ddafe7659adffad8a58ca3911c1afa8b509355e7aa58b02feb35d9b6"
				}
			]
		},
		{
			"name": "glpk",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://ftp.gnu.org/gnu/glpk/glpk-4.63.tar.gz",
					"sha256": "914d27f1a51c2bf4a51f1bd4a507f875fcca99db7b219380b836a25b29b3e7f6"
				}
			]
		},
		{
			"name": "portaudio",
			"sources":
			[
				{
					"type": "archive",
					"url": "http://www.portaudio.com/archives/pa_stable_v190600_20161030.tgz",
					"sha256": "f5a21d7dcd6ee84397446fa1fa1a0675bb2e8a4a6dceb4305a8404698d8d1513"
				}
			]
		},
		{
			"name": "graphicsmagick",
			"config-opts":
			[
				"--enable-shared=yes"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "https://sourceforge.net/projects/graphicsmagick/files/graphicsmagick/1.3.26/GraphicsMagick-1.3.26.tar.bz2",
					"sha256": "054bd6e10c6d82b6adb36d1a9f860e9db90689d3b61e77a344d2f962b33167e5"
				}
			]
		},
		{
			"name": "arpack-ng",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://github.com/opencollab/arpack-ng/archive/3.5.0.tar.gz",
					"sha256": "50f7a3e3aec2e08e732a487919262238f8504c3ef927246ec3495617dde81239"
				}
			]
		},
		{
			"name": "fftw3",
			"no-autogen": true,
			"config-opts":
			[
				"--enable-shared"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "http://www.fftw.org/fftw-3.3.6-pl2.tar.gz",
					"sha256": "a5de35c5c824a78a058ca54278c706cdf3d4abba1c56b63531c2cb05f5d57da2"
				}
			]
		},
		{
			"name": "fftw3f",
			"no-autogen": true,
			"config-opts":
			[
				"--enable-shared",
				"--enable-float"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "http://www.fftw.org/fftw-3.3.6-pl2.tar.gz",
					"sha256": "a5de35c5c824a78a058ca54278c706cdf3d4abba1c56b63531c2cb05f5d57da2"
				}
			]
		},
		{
			"name": "mesa",
			"config-opts":
			[
				"--enable-osmesa"
			],
			"sources":
			[
				{
					"type": "archive",
					"url": "https://mesa.freedesktop.org/archive/mesa-17.2.0-rc6.tar.gz",
					"sha256": "ce25345b7da886cdc730299065e2f27ac285eddc75c89595be16cb8ec8497fcc"
				}
			]
		},
		{
			"name": "sundials",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://github.com/opencollab/arpack-ng/archive/3.5.0.tar.gz",
					"sha256": "50f7a3e3aec2e08e732a487919262238f8504c3ef927246ec3495617dde81239"
				}
			]
		},
		{
			"name": "sundials-ida",
			"buildsystem": "cmake",
			"config-opts":
			[
				"-DKLU_ENABLE=ON",
				"-DKLU_INCLUDE_DIR:PATH=/app/include",
				"-DKLU_LIBRARY_DIR:PATH=/app/lib"
			],
			"builddir": true,
			"sources":
			[
				{
					"type": "archive",
					"url": "https://computation.llnl.gov/projects/sundials/download/ida-2.9.0.tar.gz",
					"sha256": "37dee0613c00beb35c1fa08f4ba0786cb97e5e6a834612d68b1e41e9282fd1de"
				}
			]
		},
		{
			"name": "qscintilla",
			"buildsystem": "simple",
			"sources":
			[
				{
					"type": "archive",
					"url": "https://sourceforge.net/projects/pyqt/files/QScintilla2/QScintilla-2.10/QScintilla_gpl-2.10.tar.gz",
					"sha256": "16be30577bc178470936c458551f2512cc068aff6e7a7de6ed244e28c045f6ec"
				},
				{
					"type": "script",
					"commands":
					[
						"cd Qt4Qt5",
						"qmake QT_INSTALL_HEADERS=/app/include QT_INSTALL_LIBS=/app/lib"
					],
					"dest-filename": "configure"
				}
			],
			"build-commands":
			[
				"./configure --prefix=/app",
				"make -C Qt4Qt5 install",
				"ln -s /app/lib/libqscintilla2_qt5.so /app/lib/libqscintilla2-qt5.so"
			]
		},
		{
			"name": "octave",
			"config-opts":
			[
				"--with-blas=openblas"
			],
			"make-install-args": [
				"prefix=/app"
			],
			"sources":
			[
				{
					"type": "archive",
					"path": "octave-4.3.0+.tar.gz",
					"sha256": "bd8cbcbac61cf552479e2163394ee4b7c6aeef7bd7a660ed1ddc1b48bb6f4899"
				},
				{
					"type": "patch",
					"path": "appdata.patch"
				},
				{
					"type": "shell",
					"commands": ["autoreconf -i"]
				}
			]
		}
	]
}
